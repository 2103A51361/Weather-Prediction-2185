# -*- coding: utf-8 -*-
"""KNN Weather Prediction 2185.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1WLf1Gy5TDiZGHdx3eKkLAM89pDhNdGLd
"""

from google.colab import files

uploaded = files.upload()

for fn in uploaded.keys():
  print('User uploaded file "{name}" with length {length} bytes'.format(
      name=fn, length=len(uploaded[fn])))

import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
ds=pd.read_csv("weather.csv")

# Shape of data i.e no.of rows and columns
print(ds.shape)

print(ds.head())

#Alloting independent values to x
X=ds.iloc[:,1:-1].values
print(X)

#Alloting dependent values to y
y=ds.iloc[:,-1].values
print(y)

from sklearn.neighbors import KNeighborsClassifier
from sklearn import preprocessing
from sklearn import metrics

#Preprocessing/Scaling our data
X=preprocessing.scale(X)

from sklearn.model_selection import train_test_split
#Splitting Dataset into training and testing set
X_train,X_test,y_train,y_test=train_test_split(X,y,test_size=0.3,random_state=50)
print("X_train\n",X_train)
print("X_test\n",X_test)
print("y_train\n",y_train)
print("y_test\n",y_test)

# Training the model
clf=KNeighborsClassifier()
clf.fit(X_train,y_train)

#Prediction
y_pred=clf.predict(X_test)

#Confusion Matrix
from sklearn.metrics import confusion_matrix
cm=confusion_matrix(clf.predict(X_test),y_test)
print(cm)

#Graphical Confusion Matrix
from sklearn.metrics import ConfusionMatrixDisplay
ConfusionMatrixDisplay(cm).plot()

#Accuracy Score
from sklearn.metrics import accuracy_score
print("Weather health Prediction accuracy using KNN is ")
accuracy_score(clf.predict(X_test),y_test)